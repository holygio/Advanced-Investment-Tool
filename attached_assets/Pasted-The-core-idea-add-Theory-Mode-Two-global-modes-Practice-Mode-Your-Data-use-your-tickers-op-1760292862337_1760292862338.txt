The core idea: add â€œTheory Modeâ€

Two global modes:

Practice Mode (Your Data): use your tickers (optional, API/CSV).

Theory Mode (Model Worlds): pick a â€œworldâ€ with built-in data generators or casepacks designed to manifest each theory.

Each module then works in both modes. In Theory Mode we donâ€™t need APIs at all.

Theory Worlds (offline, reproducible)
1) CAPM World

Goal: see CML/SML, beta pricing, Famaâ€“MacBeth, GRS, all cleanly.

Generator: choose K assets with â€œtrueâ€ betas 
ğ›½
ğ‘–
âˆ¼
ğ‘
(
1
,
0.5
2
)
Î²
i
	â€‹

âˆ¼N(1,0.5
2
). Simulate market factor 
ğ‘“
ğ‘€
f
M
	â€‹

 and idiosyncratic 
ğœ€
ğ‘–
Îµ
i
	â€‹

:

ğ‘Ÿ
ğ‘–
,
ğ‘¡
=
ğ‘Ÿ
ğ‘“
+
ğ›½
ğ‘–
ğ‘“
ğ‘€
,
ğ‘¡
+
ğœ€
ğ‘–
,
ğ‘¡
r
i,t
	â€‹

=r
f
	â€‹

+Î²
i
	â€‹

f
M,t
	â€‹

+Îµ
i,t
	â€‹


ğ‘“
ğ‘€
,
ğ‘¡
âˆ¼
ğ‘
(
ğœ‡
ğ‘€
,
ğœ
ğ‘€
2
)
,
Â 
ğœ€
ğ‘–
,
ğ‘¡
âˆ¼
ğ‘
(
0
,
ğœ
ğœ€
,
ğ‘–
2
)
f
M,t
	â€‹

âˆ¼N(Î¼
M
	â€‹

,Ïƒ
M
2
	â€‹

),Â Îµ
i,t
	â€‹

âˆ¼N(0,Ïƒ
Îµ,i
2
	â€‹

)

Knobs: 
ğ‘Ÿ
ğ‘“
,
ğœ‡
ğ‘€
,
ğœ
ğ‘€
r
f
	â€‹

,Î¼
M
	â€‹

,Ïƒ
M
	â€‹

, cross-sectional dispersion of 
ğ›½
Î², idio variances, T (sample length).

Demonstrations: Efficient frontier â†’ tangency; SML plot with true vs estimated betas; Famaâ€“MacBeth recovers 
ğœ†
ğ‘€
Î»
M
	â€‹

; GRS ~ donâ€™t reject under correct spec.

2) FF-5(+MOM) World (Anomalies / Multi-factor)

Goal: show size/value/momentum/etc. really price returns.

Generator: factors 
ğ‘“
=
[
ğ‘€
ğ¾
ğ‘‡
,
ğ‘†
ğ‘€
ğµ
,
ğ»
ğ‘€
ğ¿
,
ğ‘…
ğ‘€
ğ‘Š
,
ğ¶
ğ‘€
ğ´
,
ğ‘€
ğ‘‚
ğ‘€
]
f=[MKT,SMB,HML,RMW,CMA,MOM] with chosen means/cov, assets with â€œtrueâ€ betas:

ğ‘Ÿ
ğ‘–
,
ğ‘¡
=
ğ‘Ÿ
ğ‘“
+
âˆ‘
ğ‘˜
ğ›½
ğ‘–
ğ‘˜
ğ‘“
ğ‘˜
,
ğ‘¡
+
ğœ€
ğ‘–
,
ğ‘¡
r
i,t
	â€‹

=r
f
	â€‹

+âˆ‘
k
	â€‹

Î²
ik
	â€‹

f
k,t
	â€‹

+Îµ
i,t
	â€‹


Knobs: switch factors on/off, adjust factor means/correlations, add mild mis-specification (omit a factor in the regression) to produce alphas on purpose.

Demo: CAPM 
ğ‘…
2
R
2
 low â†’ multi-factor 
ğ‘…
2
R
2
 higher; visualize RÂ² improvement and loadings heatmap.

3) LPM / Downside World (Higher moments without APIs)

Goal: show why variance misses downside risk.

Generator A (mixture-normal): draw returns from a 2-mix Normal to get fat left tails (controls for skew/kurtosis).

Generator B (skew-t): directly set skewness/kurtosis (skew-t or Johnson SU).

Knobs: skew, tail index, threshold 
ğœ
Ï„ (0, 
ğ‘Ÿ
ğ‘“
r
f
	â€‹

, benchmark return), order 
ğ‘›
n (1,2,3).

Demo: compare MV vs semivariance frontiers; LPM surface heatmap; co-LPM â€œbetaâ€ vs covariance beta.

4) Utility & SDF World

Goal: see how preferences map to state pricing.

Generator: simulate consumption growth path 
Î”
log
â¡
ğ‘
ğ‘¡
Î”logc
t
	â€‹

 (AR(1) or iid), plus one or two asset returns tied to â€œgood/bad statesâ€.

Knobs: utility family (CRRA/CARA/DARA), 
ğ›¾
Î³, discount 
ğ›½
Î², correlation between returns and consumption.

Demo: compute 
ğ‘š
ğ‘¡
âˆ
ğ›½
ğ‘ˆ
â€²
(
ğ‘
ğ‘¡
+
1
)
ğ‘ˆ
â€²
(
ğ‘
ğ‘¡
)
m
t
	â€‹

âˆÎ²
U
â€²
(c
t
	â€‹

)
U
â€²
(c
t+1
	â€‹

)
	â€‹

 â†’ show 
1
âˆ’
ğ¸
[
ğ‘š
ğ‘…
]
1âˆ’E[mR] pricing error for assets; overlay CAPM SDF (affine in 
ğ‘…
ğ‘€
R
M
	â€‹

) vs utility-based SDF; highlight bad states.

5) Term/Credit (Fixed Income) World

Goal: yield curves, term spread, credit premiaâ€”no external data.

Generator: choose Nelson-Siegel-Svensson parameters 
(
ğ›½
0
,
ğ›½
1
,
ğ›½
2
,
ğ›½
3
,
ğœ
1
,
ğœ
2
)
(Î²
0
	â€‹

,Î²
1
	â€‹

,Î²
2
	â€‹

,Î²
3
	â€‹

,Ï„
1
	â€‹

,Ï„
2
	â€‹

) per date to simulate curves; compute bond prices/durations.

Credit: add rating-bucket OAS levels; simulate downgrades to show discontinuities.

Demo: â€œnormal vs invertedâ€ curves; term spread path; equity-bond 5-factor SDF example (Market/SMB/HML/TERM/CREDIT).

6) Risk-Neutral World (Options)

Goal: intuition for 
ğ‘„
Q vs 
ğ‘ƒ
P.

Generator: single-period binomial or Black-Scholes sandbox.

Knobs: 
ğ‘†
,
ğ¾
,
ğ‘Ÿ
,
ğ‘‡
,
ğœ
S,K,r,T,Ïƒ (or 
ğ‘¢
,
ğ‘‘
u,d).

Demo: compute risk-neutral 
ğ‘
ğ‘„
p
Q
	â€‹

, price a call, compare to physical expected payoffs; visualize payoff states and state prices.

UI: how to switch and what to show

Global toggle: Theory Mode / Practice Mode.

Theory Mode landing: grid of â€œWorldsâ€. Each world opens with:

a small theory card (equations + assumptions),

knobs (sliders/inputs),

Generate button (fixed random seed for reproducibility),

charts + tables that mirror the Practice module visuals.

Examples:

Factor Analyzer in Theory Mode â†’ Generate FF-5 world â†’ plot factor premia, correlation heatmap, loadings table, RÂ² improvement chartâ€”no API.

Risk & Performance in Theory Mode â†’ Generate LPM world â†’ histogram + QQ plot, JB test, LPM heatmap, semivariance frontier.

Minimal math details (so Lovable can implement)

CAPM World:

Draw 
ğ‘“
ğ‘€
âˆ¼
ğ‘
(
ğœ‡
ğ‘€
,
ğœ
ğ‘€
2
)
f
M
	â€‹

âˆ¼N(Î¼
M
	â€‹

,Ïƒ
M
2
	â€‹

), 
ğœ€
ğ‘–
âˆ¼
ğ‘
(
0
,
ğœ
ğœ€
,
ğ‘–
2
)
Îµ
i
	â€‹

âˆ¼N(0,Ïƒ
Îµ,i
2
	â€‹

).

Set 
ğ‘Ÿ
ğ‘–
,
ğ‘¡
=
ğ‘Ÿ
ğ‘“
+
ğ›½
ğ‘–
ğ‘“
ğ‘€
,
ğ‘¡
+
ğœ€
ğ‘–
,
ğ‘¡
r
i,t
	â€‹

=r
f
	â€‹

+Î²
i
	â€‹

f
M,t
	â€‹

+Îµ
i,t
	â€‹

.

Estimate via OLS on 
ğ‘Ÿ
ğ‘–
,
ğ‘¡
âˆ’
ğ‘Ÿ
ğ‘“
r
i,t
	â€‹

âˆ’r
f
	â€‹

 vs 
ğ‘“
ğ‘€
,
ğ‘¡
f
M,t
	â€‹

. Neweyâ€“West SEs optional.

FF-World:

Factors 
ğ‘“
ğ‘¡
âˆ¼
ğ‘
(
ğœ‡
ğ‘“
,
Î£
ğ‘“
)
f
t
	â€‹

âˆ¼N(Î¼
f
	â€‹

,Î£
f
	â€‹

), assets 
ğ‘Ÿ
ğ‘–
,
ğ‘¡
=
ğ‘Ÿ
ğ‘“
+
ğ›½
ğ‘–
âŠ¤
ğ‘“
ğ‘¡
+
ğœ€
ğ‘–
,
ğ‘¡
r
i,t
	â€‹

=r
f
	â€‹

+Î²
i
âŠ¤
	â€‹

f
t
	â€‹

+Îµ
i,t
	â€‹

.

Compare 
ğ‘…
2
R
2
 under CAPM vs full 
ğ¾
K-factor.

LPM:

Mixture Normal: 
ğ‘…
âˆ¼
ğœ‹
ğ‘
(
ğœ‡
1
,
ğœ
1
2
)
+
(
1
âˆ’
ğœ‹
)
ğ‘
(
ğœ‡
2
,
ğœ
2
2
)
Râˆ¼Ï€N(Î¼
1
	â€‹

,Ïƒ
1
2
	â€‹

)+(1âˆ’Ï€)N(Î¼
2
	â€‹

,Ïƒ
2
2
	â€‹

).

ğ¿
ğ‘ƒ
ğ‘€
ğ‘›
(
ğœ
)
=
1
ğ‘‡
âˆ‘
min
â¡
(
ğ‘…
ğ‘¡
âˆ’
ğœ
,
0
)
ğ‘›
LPM
n
	â€‹

(Ï„)=
T
1
	â€‹

âˆ‘min(R
t
	â€‹

âˆ’Ï„,0)
n
.

Plot MV vs semivariance frontier side-by-side.

Utility & SDF:

CRRA: 
ğ‘ˆ
(
ğ‘¥
)
=
ğ‘¥
1
âˆ’
ğ›¾
1
âˆ’
ğ›¾
U(x)=
1âˆ’Î³
x
1âˆ’Î³
	â€‹

 (log if 
ğ›¾
=
1
Î³=1).

SDF: 
ğ‘š
ğ‘¡
âˆ
ğ›½
ğ‘ˆ
â€²
(
ğ‘
ğ‘¡
+
1
)
ğ‘ˆ
â€²
(
ğ‘
ğ‘¡
)
m
t
	â€‹

âˆÎ²
U
â€²
(c
t
	â€‹

)
U
â€²
(c
t+1
	â€‹

)
	â€‹

.

Show 
pricingÂ error
=
1
âˆ’
ğ¸
[
ğ‘š
ğ‘…
]
pricingÂ error=1âˆ’E[mR].

Yield curve:

Fit NSS curve locally to a few points; compute term spread (10yâ€“3m).

Credit proxy = OAS level per rating bucket (user slider) or difference of two synthetic bond baskets.

Risk-neutral:

Binomial: solve 
ğ‘
ğ‘„
p
Q
	â€‹

 from 
ğ¸
ğ‘„
[
ğ‘…
]
=
ğ‘Ÿ
ğ‘“
E
Q
[R]=r
f
	â€‹

.

Black-Scholes sandbox for intuition; no live chains needed.

Implementation sketch (Lovable follow-up prompt)

â€œAdd a Theory Mode with six offline Model Worlds (CAPM, FF-5, LPM, Utility/SDF, Term/Credit, Risk-Neutral). For each:

Provide a generator function with a fixed random seed, adjustable knobs, and a Generate button.

Reuse existing charts/tables from Practice Mode (frontier, SML, factor table, heatmaps, LPM surfaces, yield curves).

Ship a data/casepacks/ folder with small CSVs as defaults (so users can click through without inputs).

Expose a global toggle in the header: Theory / Practice.

Ensure every Theory chart has a short â€œWhat this showsâ€ tooltip tying back to lecture slides.â€

Why this works

You see the model on data that actually demonstrates it (no API, no fragile links).

You can dial in skew, kurtosis, factor premia, yield curvesâ€”so the theory becomes visual and tactile.

Then, when you want, switch to Practice Mode and try your own 5â€“10 stocksâ€”knowing exactly what to expect (and not expect).