ğŸ¯ Goal

Rebuild and extend the Risk module to (1) include a full, first-principles Theory tab aligned with Advanced Investments â€“ Lecture 4, and (2) expand the empirical analysis to incorporate skewness and kurtosis metrics for the userâ€™s real Yahoo Finance portfolio.

The module should now let users:

Quantify portfolio skewness, kurtosis, and Jarqueâ€“Bera normality.

Compare them to a normal benchmark.

Visualize distribution shape (histogram + QQ-plot).

Integrate skew/kurtosis into the risk narrative (beyond Ïƒ and LPM).

âš™ï¸ Structure Overview

Frontend

/theory/risk/page.tsx      # Theory cards (offline)
 /practice/risk/page.tsx    # Real-data risk metrics + visuals


Backend

/api/risk/metrics          # Computes variance, skew, kurt, JB, LPM, ratios
/api/risk/distribution     # Returns histogram + QQ data

ğŸ§  Theory Tab â€” /theory/risk/page.tsx

Keep the 9 TheoryCards already defined in your existing spec, but make explicit references to skewness and kurtosis throughout.

Add a dedicated new section â€œDistribution Shape: Skewness & Kurtosis (Bridge to Practice)â€ between sections 3 and 4.

ğŸ”¹ New Section â€” Distribution Shape: Skewness & Kurtosis (Bridge to Practice)

Goal: Explain these metrics conceptually and show why they must also be measured empirically.

Definition Recap

Skew
=
ğ¸
[
(
ğ‘Ÿ
âˆ’
ğœ‡
)
3
]
ğœ
3
,
Kurt
=
ğ¸
[
(
ğ‘Ÿ
âˆ’
ğœ‡
)
4
]
ğœ
4
Skew=
Ïƒ
3
E[(râˆ’Î¼)
3
]
	â€‹

,Kurt=
Ïƒ
4
E[(râˆ’Î¼)
4
]
	â€‹


Skewness: Measures asymmetry.
Positive = long right tail (occasional big gains).
Negative = long left tail (occasional big losses).

Kurtosis: Measures tail thickness.
Normal = 3; above 3 â‡’ â€œfat tailsâ€ = large jumps more frequent.

Jarqueâ€“Bera test: combines both to test normality:

ğ½
ğµ
=
ğ‘›
6
(
Skew
2
+
(
Kurt
âˆ’
3
)
2
4
)
JB=
6
n
	â€‹

(Skew
2
+
4
(Kurtâˆ’3)
2
	â€‹

)

Economic meaning

Negative skew = lottery in reverse â†’ people dislike it.

Excess kurtosis = crash risk â†’ investors demand premium.

Portfolio diversification reduces variance but not necessarily tails.

So what? Two portfolios can have the same Ïƒ but very different risk experience.
Skew/kurt give richer insight into real-world downside.

ğŸ“Š Empirical Integration â€” /practice/risk/page.tsx
ğŸ”¸ Add new functionality

In the existing â€œRisk Dashboardâ€ (where Sharpe, Treynor, LPM, etc. appear):

A. Compute and display
For the current portfolio (based on user-selected Yahoo Finance tickers and date range):

Mean, Variance, Ïƒ

Skewness

Kurtosis

Jarqueâ€“Bera statistic (with p-value)

Sharpe, Treynor, IR, Jensenâ€™s Î±, MÂ²

B. Visualize

Histogram of portfolio returns, overlaying a normal curve with same Î¼ and Ïƒ.

QQ-Plot: actual vs normal quantiles â†’ highlight fat tails visually.

Optional: small tooltip showing:
â€œJB rejects normality â‡’ variance alone insufficient; use LPM or higher moments.â€

C. Interpretive summary (below charts)
Generate short textual insights such as:

â€œYour portfolio has negative skewness (â€“0.48) â†’ occasional large losses dominate risk perception.â€
â€œKurtosis = 6.1 â‡’ fat tails; returns not normal.
Consider using LPM or downside-risk optimization.â€

ğŸ”¹ Backend Implementation â€” /api/risk/metrics

Expected inputs:

{
  "returns": [ ... daily or monthly % returns ... ],
  "rf": 0.03
}


Outputs:

{
  "mean": 0.012,
  "stdev": 0.045,
  "skew": -0.35,
  "kurt": 5.8,
  "jb": 7.41,
  "jb_pval": 0.03,
  "sharpe": 0.42,
  "treynor": 0.18,
  "info_ratio": 0.21,
  "alpha": 0.005,
  "m2": 0.012
}


Implementation logic:

Use scipy.stats (skew, kurtosis, jarque_bera)

Add Sharpe/Treynor/IR formulas already used

Return all in JSON to render on front-end cards

ğŸ”¹ Charts Implementation â€” /frontend/components/charts/

RiskDistributionPlot.tsx â†’ Histogram + normal overlay

QQPlot.tsx â†’ Quantile comparison

Add ExplainTip: â€œFat tails indicate rare extreme events; kurtosis>3 => higher tail risk.â€

Add ExplainTip: â€œNegative skew = frequent small gains, rare large losses.â€

âœ… Acceptance Criteria
Area	Description	Status
Theory	Complete 9-card layout + new â€œSkewness & Kurtosisâ€ section	âœ…
Practice	Compute skew, kurt, JB, and display hist + QQ plots	âœ…
Integration	Theoretical + empirical link between shape and performance	âœ…
UI	New ExplainTips for tails and asymmetry	âœ…
Backend	Returns skew/kurt/jb metrics along with other ratios	âœ…
Offline / Real Data	Theory offline, Practice uses Yahoo Finance portfolio returns	âœ…
ğŸ§© Summary of User Experience

In the Theory tab, users learn what skewness and kurtosis mean, why variance is not enough, and how they tie to tail risk and investor preferences.

In the Practice tab, they see and measure those properties for their real portfolio.

Together, this forms a continuous narrative:
From abstract tail aversion â†’ to statistical evidence â†’ to portfolio evaluation.