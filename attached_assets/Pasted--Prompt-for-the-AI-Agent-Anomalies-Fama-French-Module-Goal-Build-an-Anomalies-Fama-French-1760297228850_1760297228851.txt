ğŸ§© Prompt for the AI Agent â€“ Anomalies & Fama French Module

Goal:
Build an â€œAnomalies & Fama Frenchâ€ module with two sub-modules:
1ï¸âƒ£ Three-Factor Model (1993)
2ï¸âƒ£ Five-Factor Model (2015)
Each sub-module must first show the model formula and theoretical explanation, then run the empirical analysis.

ğŸ§± 1. Datasets

I will upload two CSVs from the Ken French Data Library (https://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html):

/data/factors/F-F_Research_Data_Factors.csv â†’ Famaâ€“French 3-Factor Model
Variables: Mkt-RF, SMB, HML, RF

/data/factors/F-F_Research_Data_5_Factors_2x3.csv â†’ Famaâ€“French 5-Factor Model
Variables: Mkt-RF, SMB, HML, RMW, CMA, RF

Each dataset is monthly, percentages that must be divided by 100.
Convert date columns to datetime, rename columns clearly, and merge with a sample portfolio return dataset (synthetic if none uploaded).

âš™ï¸ 2. Structure
A. Theory Block (visible in frontend first)

Show the model formula and define each term.

Three-Factor Model (1993):

ğ‘…
ğ‘–
âˆ’
ğ‘…
ğ‘“
=
ğ›¼
ğ‘–
+
ğ›½
ğ‘–
ğ‘€
(
ğ‘…
ğ‘€
âˆ’
ğ‘…
ğ‘“
)
+
ğ‘ 
ğ‘–
â€‰
ğ‘†
ğ‘€
ğµ
+
â„
ğ‘–
â€‰
ğ»
ğ‘€
ğ¿
+
ğœ€
ğ‘–
R
i
	â€‹

âˆ’R
f
	â€‹

=Î±
i
	â€‹

+Î²
iM
	â€‹

(R
M
	â€‹

âˆ’R
f
	â€‹

)+s
i
	â€‹

SMB+h
i
	â€‹

HML+Îµ
i
	â€‹


Explain:

ğ‘…
ğ‘–
âˆ’
ğ‘…
ğ‘“
R
i
	â€‹

âˆ’R
f
	â€‹

: excess return

ğ‘…
ğ‘€
âˆ’
ğ‘…
ğ‘“
R
M
	â€‹

âˆ’R
f
	â€‹

: market risk premium

SMB: small minus big (size factor)

HML: high minus low (value factor)

Î±: pricing error

Five-Factor Model (2015):

ğ‘…
ğ‘–
âˆ’
ğ‘…
ğ‘“
=
ğ›¼
ğ‘–
+
ğ›½
ğ‘–
ğ‘€
(
ğ‘…
ğ‘€
âˆ’
ğ‘…
ğ‘“
)
+
ğ‘ 
ğ‘–
â€‰
ğ‘†
ğ‘€
ğµ
+
â„
ğ‘–
â€‰
ğ»
ğ‘€
ğ¿
+
ğ‘Ÿ
ğ‘–
â€‰
ğ‘…
ğ‘€
ğ‘Š
+
ğ‘
ğ‘–
â€‰
ğ¶
ğ‘€
ğ´
+
ğœ€
ğ‘–
R
i
	â€‹

âˆ’R
f
	â€‹

=Î±
i
	â€‹

+Î²
iM
	â€‹

(R
M
	â€‹

âˆ’R
f
	â€‹

)+s
i
	â€‹

SMB+h
i
	â€‹

HML+r
i
	â€‹

RMW+c
i
	â€‹

CMA+Îµ
i
	â€‹


Add:

RMW: robust minus weak (profitability factor)

CMA: conservative minus aggressive (investment factor)

Each theory block must display formula, variable definitions, and short text from lecture slides (slides 9â€“23) explaining the economic rationale (size, value, momentum, profitability, investment).

B. Empirical Analysis Block

Data Loading & Cleaning

Load CSVs and convert to decimal.

Display first 5 rows.

Descriptive Statistics

Means, std devs, correlations matrix â†’ heatmap.

Factor premia over time (line chart).

Regressions

Estimate:

ğ‘…
ğ‘–
âˆ’
ğ‘…
ğ‘“
=
ğ›¼
+
ğ›½
ğ‘€
(
ğ‘€
ğ‘˜
ğ‘¡
âˆ’
ğ‘…
ğ¹
)
+
ğ›½
ğ‘†
ğ‘€
ğµ
ğ‘†
ğ‘€
ğµ
+
ğ›½
ğ»
ğ‘€
ğ¿
ğ»
ğ‘€
ğ¿
â€‰
(
+
ğ›½
ğ‘…
ğ‘€
ğ‘Š
ğ‘…
ğ‘€
ğ‘Š
+
ğ›½
ğ¶
ğ‘€
ğ´
ğ¶
ğ‘€
ğ´
)
R
i
	â€‹

âˆ’R
f
	â€‹

=Î±+Î²
M
	â€‹

(Mktâˆ’RF)+Î²
SMB
	â€‹

SMB+Î²
HML
	â€‹

HML(+Î²
RMW
	â€‹

RMW+Î²
CMA
	â€‹

CMA)

Return Î±, Î²s, t-stats, RÂ² for each portfolio/asset.

Compare CAPM vs FF3 vs FF5 (RÂ² and Î± differences).

Visualization Layer

Factor premia heatmap

Cumulative factor returns line chart

Bar chart of alphas and RÂ² for each model

Toggle switch (3-Factor / 5-Factor mode)

ğŸ§  3. Frontend/Backend Layout

Frontend

AnomaliesWorld.jsx â†’ parent module

Tabs: 3-Factor Model, 5-Factor Model, GRS Test (optional)

Add a small TheoryCard above each tab showing the formula.

Backend

ff_world.py with FastAPI endpoints:

/api/factors/ff3/analyze

/api/factors/ff5/analyze
Each endpoint reads CSV and runs the OLS regressions.

Use pandas, numpy, statsmodels.api as sm, plotly.express.

ğŸ§® 4. Bonus Feature (Theory Link)

Add a button: â€œShow Economic Interpretationâ€.
When clicked, display lecture-based text explaining why each factor exists (e.g., â€œSize premium = liquidity risk compensationâ€).
Source text from Lecture slides 9â€“23 and 38.

ğŸ“ 5. Offline Operation

No API calls required.

Read from the two CSV files only.

If not found, generate synthetic data with the same structure.

ğŸ§© 6. (Optionally for Later)

Include a GRS Test section that compares joint significance of Î± values across sorted portfolios (slides 30â€“32).