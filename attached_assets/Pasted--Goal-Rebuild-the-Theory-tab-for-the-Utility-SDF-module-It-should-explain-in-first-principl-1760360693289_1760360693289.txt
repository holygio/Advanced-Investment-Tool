ğŸ¯ Goal

Rebuild the Theory tab for the â€œUtility & SDFâ€ module.
It should explain, in first-principles language with complete formulas, how utility functions generate risk aversion, how marginal utility defines the stochastic discount factor (SDF), and how stochastic dominance formalizes preference orders beyond mean-variance.
End by connecting the theory to LPM-based SDFs as in Bawa-Lindenberg (1977).
No real dataâ€”text + LaTeX equations + intuitive illustrations only.

Page Layout

/theory/utility/page.tsx
Use collapsible â€œTheoryCardsâ€ with 6-8 sections:

1ï¸âƒ£ Why Utility Matters in Asset Pricing

Utility functions formalize how investors trade off risk vs return.

The shape of the utility function â†’ the SDF, which prices assets through

1
=
ğ¸
[
ğ‘š
ğ‘¡
+
1
ğ‘…
ğ‘¡
+
1
]
where
ğ‘š
ğ‘¡
+
1
âˆ
ğ‘ˆ
â€²
(
ğ¶
ğ‘¡
+
1
)
1=E[m
t+1
	â€‹

R
t+1
	â€‹

]wherem
t+1
	â€‹

âˆU
â€²
(C
t+1
	â€‹

)

Risk aversion â‡’ marginal utility declines as wealth rises.
â€œGood-stateâ€ payoffs are less valuable than â€œbad-stateâ€ payoffs.

So what? Every modelâ€”from CAPM to multifactorâ€”implies a specific functional form for 
ğ‘ˆ
(
ğ‘¥
)
U(x) and hence 
ğ‘š
m.

2ï¸âƒ£ Traditional Utility Forms: CARA, CRRA, DARA
Type	Formula	Risk-aversion measure	Economic interpretation
CRRA	
ğ‘ˆ
(
ğ‘¥
)
=
ğ‘¥
1
âˆ’
ğ›¾
âˆ’
1
1
âˆ’
ğ›¾
U(x)=
1âˆ’Î³
x
1âˆ’Î³
âˆ’1
	â€‹

 or 
ln
â¡
ğ‘¥
lnx if 
ğ›¾
=
1
Î³=1	
ğ‘…
ğ‘…
ğ´
(
ğ‘¥
)
=
âˆ’
ğ‘¥
ğ‘ˆ
â€²
â€²
(
ğ‘¥
)
ğ‘ˆ
â€²
(
ğ‘¥
)
=
ğ›¾
RRA(x)=âˆ’x
U
â€²
(x)
U
â€²â€²
(x)
	â€‹

=Î³ (constant)	Risk aversion constant as % of wealth â†’ â€œscale-invariant.â€
CARA	
ğ‘ˆ
(
ğ‘¥
)
=
âˆ’
ğ‘’
âˆ’
ğ‘
ğ‘¥
U(x)=âˆ’e
âˆ’bx
, 
ğ‘
>
0
b>0	
ğ´
ğ‘…
ğ´
(
ğ‘¥
)
=
âˆ’
ğ‘ˆ
â€²
â€²
(
ğ‘¥
)
ğ‘ˆ
â€²
(
ğ‘¥
)
=
ğ‘
ARA(x)=âˆ’
U
â€²
(x)
U
â€²â€²
(x)
	â€‹

=b (constant)	Same aversion regardless of wealthâ€”useful for absolute payoffs.
DARA	e.g. 
ğ‘ˆ
(
ğ‘¥
)
=
ln
â¡
ğ‘¥
U(x)=lnx	
ğ´
ğ‘…
ğ´
ARA declines with x	Richer investors care less about losing a fixed amount.

Graph: concave curve with diminishing slope â†’ decreasing marginal utility.

So what? Utility curvature = risk aversion; convexity of 
ğ‘ˆ
â€²
U
â€²
 drives pricing kernel curvature.

3ï¸âƒ£ From Marginal Utility to the SDF

Marginal utility 
ğ‘ˆ
â€²
(
ğ¶
ğ‘¡
+
1
)
U
â€²
(C
t+1
	â€‹

) defines how future payoffs are valued today.

ğ‘š
ğ‘¡
+
1
=
ğ›½
ğ‘ˆ
â€²
(
ğ¶
ğ‘¡
+
1
)
ğ‘ˆ
â€²
(
ğ¶
ğ‘¡
)
m
t+1
	â€‹

=Î²
U
â€²
(C
t
	â€‹

)
U
â€²
(C
t+1
	â€‹

)
	â€‹


Higher future consumption â†’ lower 
ğ‘ˆ
â€²
(
ğ¶
ğ‘¡
+
1
)
U
â€²
(C
t+1
	â€‹

) â†’ smaller 
ğ‘š
ğ‘¡
+
1
m
t+1
	â€‹

: assets paying in good states are less valuable.

CAPM version:

ğ‘š
ğ‘¡
+
1
=
ğ‘
+
ğ‘
ğ‘…
ğ‘€
,
ğ‘¡
+
1
,
ğ‘
<
0
m
t+1
	â€‹

=a+bR
M,t+1
	â€‹

,b<0

ensures decreasing SDF = risk aversion.

So what? 
ğ‘š
m summarizes all preferences, beliefs, and risks; â€œstate price density.â€

4ï¸âƒ£ Orders of Stochastic Dominance (SD)
Order	Utility restrictions	Economic meaning	SDF restriction
FSD	
ğ‘ˆ
â€²
>
0
U
â€²
>0	More is better (non-satiation)	
ğ‘š
>
0
m>0
SSD	
ğ‘ˆ
â€²
>
0
,
ğ‘ˆ
â€²
â€²
<
0
U
â€²
>0,U
â€²â€²
<0	Risk-averse	
ğ‘š
m decreasing
TSD	
ğ‘ˆ
â€²
>
0
,
ğ‘ˆ
â€²
â€²
<
0
,
ğ‘ˆ
â€²
â€²
â€²
>
0
U
â€²
>0,U
â€²â€²
<0,U
â€²â€²â€²
>0	Preference for positive skewness	
ğ‘š
m decreasing at decreasing rate
4th Order	add 
ğ‘ˆ
â€²
â€²
â€²
â€²
<
0
U
â€²â€²â€²â€²
<0	Kurtosis aversion	tails penalized more

Interpretation: SD ranks investments by the broadest class of investors who would prefer them. FSD â†’ â€œeveryone,â€ SSD â†’ all risk-averse, etc.

So what? SD is a generalization of MV: it works without assuming normality or quadratic U(x).

5ï¸âƒ£ CAPM vs Stochastic Dominance

CAPM assumes linear SDF: 
ğ‘š
=
ğ‘
+
ğ‘
ğ‘…
ğ‘€
m=a+bR
M
	â€‹

 with 
ğ‘
<
0
b<0.

Ensures risk aversion but may violate non-satiation for extreme 
ğ‘…
ğ‘€
R
M
	â€‹

 (m < 0).

CAPM â†’ quadratic utility â†’ valid only locally; beyond that, marginal utility can turn negative.

SD allows non-linear m, avoids negative regions, and can incorporate skew/kurtosis preferences.

So what? CAPM â‰ˆ a linearization of more general SD-consistent models; accurate near the mean, fails in extremes.

6ï¸âƒ£ Why / When Mean-Variance Still Useful

MV assumes: (i) normal returns or (ii) quadratic U.

Violates non-satiation occasionally (negative m), but serves as Taylor expansion of true U over limited range (Tsiang 1972).

Works well if extremes rare; fails under fat tails or FSD dominance.

So what? MV = second-order approximation to expected utility; acceptable locally, not universally.

7ï¸âƒ£ Beyond SSD â†’ Skewness and Kurtosis Preferences

Investors may prefer positive skewness (lottery-like payoffs) even with negative expected returns.

Corresponds to TSD (3rd order): 
ğ‘ˆ
â€²
â€²
â€²
>
0
U
â€²â€²â€²
>0.

4th order introduces kurtosis aversion (
ğ‘ˆ
â€²
â€²
â€²
â€²
<
0
U
â€²â€²â€²â€²
<0) but adds little extra realism.

So what? Adds behavioural realism: explains demand for lotteries, options, and asymmetric payoffs.

8ï¸âƒ£ Stochastic Dominance SDFs in Practice

Empirically, one can estimate m directly by minimizing pricing errors:

ğ¸
[
ğ‘š
ğ‘¡
+
1
ğ‘…
ğ‘¡
+
1
]
=
1
E[m
t+1
	â€‹

R
t+1
	â€‹

]=1

â†’ find m consistent with positivity & monotonicity.

Allows non-parametric asset-pricing tests: see Post & Versijp (2007 JFQA).

Reveals strong aversion to large losses (~ âˆ’12% region).

So what? SD-based SDFs describe how markets actually price tail risk beyond CAPM.

9ï¸âƒ£ Lower Partial Moments (LPM) â€” Bridging Utility & Risk

LPMs parameterize utility by penalizing only downside outcomes:

ğ¿
ğ‘ƒ
ğ‘€
ğ‘›
(
ğœ
)
=
ğ¸
[
max
â¡
(
ğœ
âˆ’
ğ‘…
,
0
)
ğ‘›
]
LPM
n
	â€‹

(Ï„)=E[max(Ï„âˆ’R,0)
n
]

Economic intuition: returns above Ï„ donâ€™t increase risk; only shortfalls hurt.

When returns âˆ¼ normal â‡’ MV â‰ˆ LPM; if not, LPM better fits preferences.

SDF-form equilibrium:

ğ‘š
ğ‘¡
=
ğ‘
+
ğ‘
min
â¡
(
ğ‘…
ğ‘€
âˆ’
ğ‘Ÿ
ğ‘“
,
0
)
m
t
	â€‹

=a+bmin(R
M
	â€‹

âˆ’r
f
	â€‹

,0)

â†’ risk-neutral above threshold; risk-averse below.

Combos of Ï„ and n build realistic positive-decreasing SDFs; can still yield portfolio separation with a risk-free asset.

So what? LPMs merge the utility logic with downside risk metrics, preserving non-satiation and risk aversion without assuming normality.

ğŸ”Ÿ ESG Risk (Extension)

Add optional paragraph summarizing slides 3â€“4: ESG factors can be modeled as state-contingent risks if they eventually affect returns. A â€œgreenâ€ factor (long high ESG â€“ short low ESG) fits the same SDF logic: priced only if it alters expected or downside risk.

UI / Implementation Notes

Render LaTeX; use blue (concepts), gold (formulas), green (economic intuition).

Each card ends with â€œSo what?â€ summary.

Include one expandable â€œIllustrationâ€ showing marginal utility vs wealth and the SDF curvature (no live data).

Offline-only.

âœ… Acceptance Checklist
Requirement	Expected
Explains CARA/CRRA/DARA with equations & intuition	âœ…
Connects marginal utility â†” SDF clearly	âœ…
Covers FSDâ€“TSD, CAPM vs SD, MV approximation	âœ…
Integrates LPM logic & equilibrium SDF	âœ…
Includes ESG extension (optional)	âœ…
Fully offline, formatted with LaTeX and So-what blocks	âœ…