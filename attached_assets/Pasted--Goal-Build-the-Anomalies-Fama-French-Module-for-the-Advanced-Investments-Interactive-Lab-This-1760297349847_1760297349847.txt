ğŸ¯ Goal

Build the Anomalies & Famaâ€“French Module for the Advanced Investments Interactive Lab.
This module explains and tests Famaâ€“French (3-factor and 5-factor) models and the GRS test for pricing efficiency.

It must have:

A Theory section (equations + definitions + context)

An Empirical section (descriptive stats, regressions, visualizations)

A GRS test block for model validation

All operations must work offline, using the two uploaded CSV files from the Ken French Data Library.

ğŸ“‚ Datasets

You will receive two CSV files in /data/factors/:

F-F_Research_Data_Factors.csv â†’ Famaâ€“French 3-Factor Model
Columns: Date, Mkt-RF, SMB, HML, RF

F-F_Research_Data_5_Factors_2x3.csv â†’ Famaâ€“French 5-Factor Model
Columns: Date, Mkt-RF, SMB, HML, RMW, CMA, RF

Both are monthly and percentages, so divide all factor values by 100 and convert the Date column to datetime.

If no user data is provided, generate synthetic portfolio excess returns (R_i - R_f) for 5â€“10 portfolios (e.g., random combinations of factor exposures).

ğŸ§± Module Structure

Split the module into two submodules + one validation test:

1ï¸âƒ£ Famaâ€“French 3-Factor Model (FF3)

Formula (shown in the TheoryCard first):

ğ‘…
ğ‘–
âˆ’
ğ‘…
ğ‘“
=
ğ›¼
ğ‘–
+
ğ›½
ğ‘–
ğ‘€
(
ğ‘…
ğ‘€
âˆ’
ğ‘…
ğ‘“
)
+
ğ‘ 
ğ‘–
ğ‘†
ğ‘€
ğµ
+
â„
ğ‘–
ğ»
ğ‘€
ğ¿
+
ğœ€
ğ‘–
R
i
	â€‹

âˆ’R
f
	â€‹

=Î±
i
	â€‹

+Î²
iM
	â€‹

(R
M
	â€‹

âˆ’R
f
	â€‹

)+s
i
	â€‹

SMB+h
i
	â€‹

HML+Îµ
i
	â€‹


Where:

ğ‘…
ğ‘–
âˆ’
ğ‘…
ğ‘“
R
i
	â€‹

âˆ’R
f
	â€‹

: excess return

ğ‘…
ğ‘€
âˆ’
ğ‘…
ğ‘“
R
M
	â€‹

âˆ’R
f
	â€‹

: market premium

SMB: â€œSmall Minus Bigâ€ (size)

HML: â€œHigh Minus Lowâ€ (value)

Î±: mispricing (if nonzero, model fails)

2ï¸âƒ£ Famaâ€“French 5-Factor Model (FF5)

Formula:

ğ‘…
ğ‘–
âˆ’
ğ‘…
ğ‘“
=
ğ›¼
ğ‘–
+
ğ›½
ğ‘–
ğ‘€
(
ğ‘…
ğ‘€
âˆ’
ğ‘…
ğ‘“
)
+
ğ‘ 
ğ‘–
ğ‘†
ğ‘€
ğµ
+
â„
ğ‘–
ğ»
ğ‘€
ğ¿
+
ğ‘Ÿ
ğ‘–
ğ‘…
ğ‘€
ğ‘Š
+
ğ‘
ğ‘–
ğ¶
ğ‘€
ğ´
+
ğœ€
ğ‘–
R
i
	â€‹

âˆ’R
f
	â€‹

=Î±
i
	â€‹

+Î²
iM
	â€‹

(R
M
	â€‹

âˆ’R
f
	â€‹

)+s
i
	â€‹

SMB+h
i
	â€‹

HML+r
i
	â€‹

RMW+c
i
	â€‹

CMA+Îµ
i
	â€‹


Adds:

RMW: â€œRobust Minus Weakâ€ (profitability)

CMA: â€œConservative Minus Aggressiveâ€ (investment)

âš™ï¸ Backend Implementation (ff_world.py)

Use Python (FastAPI) with:

pandas, numpy, statsmodels.api as sm, plotly.express

Endpoints:

/api/factors/ff3/analyze

/api/factors/ff5/analyze

/api/factors/grs/test

ğŸ” Step-by-Step Analysis Workflow
A. Data Preparation

Read CSV â†’ convert to decimals

Keep last 10â€“15 years (optional subset)

Align factors with synthetic or user portfolio returns

Compute excess returns: 
ğ‘…
ğ‘–
âˆ’
ğ‘…
ğ‘“
R
i
	â€‹

âˆ’R
f
	â€‹


B. Descriptive Statistics

Return:

Means, Std, Correlation matrix (Plotly heatmap)

Factor premia (line chart of cumulative sums)

C. Regressions (OLS)

For each portfolio (column of returns):

ğ‘…
ğ‘–
âˆ’
ğ‘…
ğ‘“
=
ğ›¼
ğ‘–
+
ğ›½
ğ‘€
(
ğ‘€
ğ‘˜
ğ‘¡
âˆ’
ğ‘…
ğ¹
)
+
ğ›½
ğ‘†
ğ‘€
ğµ
ğ‘†
ğ‘€
ğµ
+
ğ›½
ğ»
ğ‘€
ğ¿
ğ»
ğ‘€
ğ¿
(
+
ğ›½
ğ‘…
ğ‘€
ğ‘Š
ğ‘…
ğ‘€
ğ‘Š
+
ğ›½
ğ¶
ğ‘€
ğ´
ğ¶
ğ‘€
ğ´
)
R
i
	â€‹

âˆ’R
f
	â€‹

=Î±
i
	â€‹

+Î²
M
	â€‹

(Mktâˆ’RF)+Î²
SMB
	â€‹

SMB+Î²
HML
	â€‹

HML(+Î²
RMW
	â€‹

RMW+Î²
CMA
	â€‹

CMA)

Return:

Î±, Î²s, t-stats, RÂ² for each model

Model comparison table: CAPM vs FF3 vs FF5 (average RÂ², number of significant Î±s)

ğŸ“Š Frontend Implementation

React + Tailwind, add one page per model:

/frontend/app/factors/ff3/page.tsx

/frontend/app/factors/ff5/page.tsx

/frontend/app/factors/grs/page.tsx

Each page shows:

Top panel: TheoryCard (formula + definitions)

Left side: Controls (model selector, date range)

Main area: Charts and regression tables

ExplainTip icons: definitions for each factor

ğŸ§® GRS Test Section

Goal:
Statistically test whether all Î±â€™s from the regression are jointly zero (i.e., whether the model prices assets correctly).

ğŸ“˜ Formula:
ğº
ğ‘…
ğ‘†
=
ğ‘‡
ğ‘
(
ğ‘‡
âˆ’
ğ‘
âˆ’
ğ¾
)
(
ğ‘
(
ğ¾
+
1
)
)
Ã—
ğ›¼
^
âŠ¤
Î£
âˆ’
1
ğ›¼
^
1
+
ğœ‡
^
ğ‘“
âŠ¤
Î£
ğ‘“
âˆ’
1
ğœ‡
^
ğ‘“
GRS=
N
T
	â€‹

(N(K+1))
(Tâˆ’Nâˆ’K)
	â€‹

Ã—
1+
Î¼
^
	â€‹

f
âŠ¤
	â€‹

Î£
f
âˆ’1
	â€‹

Î¼
^
	â€‹

f
	â€‹

Î±
^
âŠ¤
Î£
âˆ’1
Î±
^
	â€‹


Where:

T = number of time periods

N = number of assets

K = number of factors

ğ›¼
^
Î±
^
 = vector of estimated intercepts

Î£
Î£ = residual covariance matrix from time-series regressions

ğœ‡
^
ğ‘“
Î¼
^
	â€‹

f
	â€‹

 = mean factor returns

Î£
ğ‘“
Î£
f
	â€‹

 = covariance matrix of factor returns

Under the null hypothesis (Hâ‚€: Î± = 0), GRS follows an F-distribution with (N, T âˆ’ N âˆ’ K) degrees of freedom.
If p-value < 0.05 â†’ reject Hâ‚€ â†’ the model fails to explain all expected returns.

ğŸ“ˆ What to Display:

Î± table (each asset, Î± and t-stat)

Overall GRS F-statistic and p-value

Verdict: â€œModel passes/does not pass pricing efficiency testâ€

Chart: Î± distribution and confidence intervals

Tooltip: â€œGRS tests if all intercepts (pricing errors) are jointly zeroâ€

ğŸ“Š Example Backend Snippet
import numpy as np
import pandas as pd
from scipy import stats

def grs_test(returns, factors, alphas, residuals):
    T, N = returns.shape
    K = factors.shape[1]
    Sigma = np.cov(residuals, rowvar=False)
    mean_f = np.mean(factors, axis=0)
    cov_f = np.cov(factors, rowvar=False)
    
    num = (T / N) * (T - N - K) / (T - K - 1)
    term1 = alphas.T @ np.linalg.inv(Sigma) @ alphas
    term2 = 1 + mean_f.T @ np.linalg.inv(cov_f) @ mean_f
    GRS = num * (term1 / term2)
    
    p_value = 1 - stats.f.cdf(GRS, N, T - N - K)
    return GRS[0,0], p_value

ğŸ§  Educational Layer (Theory Mode)

Above each chart, show short explanatory text:

â€œÎ± represents mispricing â€” if the model is correct, Î± â‰ˆ 0.â€

â€œThe GRS test checks whether all Î±s are jointly zero.â€

â€œAdding RMW and CMA typically reduces Î± variance and increases RÂ².â€

ğŸ’¾ Offline Operation

Load from the uploaded CSVs in /data/factors/

No API calls

If files not found â†’ generate synthetic factors using Normal(Î¼, ÏƒÂ²) with similar means and variances.

âœ… Acceptance Criteria

I can toggle between FF3 and FF5.

Each submodule displays theory first, then data visualizations.

The app computes regressions, shows Î±, Î², t-stats, RÂ².

The GRS test computes and displays an F-statistic and p-value.

Offline operation is functional and deterministic (seeded).